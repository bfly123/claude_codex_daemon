Index: README.md
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/README.md b/README.md
--- a/README.md	(revision acdb42e15193d62398f6460571f21a07a82ec921)
+++ b/README.md	(date 1766022523413)
@@ -84,12 +84,35 @@
 
 ## Install
 
+### Linux / macOS
+
 ```bash
 git clone https://github.com/bfly123/claude_code_bridge.git
 cd claude_code_bridge
 ./install.sh install
 ```
 
+### Windows 10/11
+
+**PowerShell / CMD:**
+```powershell
+# In PowerShell
+git clone https://github.com/bfly123/claude_code_bridge.git
+cd claude_code_bridge
+.\install.ps1 install
+
+# Add to PATH if prompted
+[Environment]::SetEnvironmentVariable('Path', "$env:Path;$env:APPDATA\Scripts", 'User')
+```
+
+**Git Bash:**
+```bash
+# Shell wrapper is auto-generated, just configure PATH
+export PATH="$APPDATA/Scripts:$PATH"
+```
+
+> **ğŸ“– Windows Users**: See [WINDOWS_INSTALL.md](WINDOWS_INSTALL.md) for detailed guide
+
 ## Start
 
 ```bash
@@ -251,12 +274,28 @@
 
 ## å®‰è£…
 
+### Linux / macOS
+
 ```bash
 git clone https://github.com/bfly123/claude_code_bridge.git
 cd claude_code_bridge
 ./install.sh install
 ```
 
+### Windows 10/11
+
+```powershell
+# åœ¨ PowerShell ä¸­è¿è¡Œ
+git clone https://github.com/bfly123/claude_code_bridge.git
+cd claude_code_bridge
+.\install.ps1 install
+
+# å¦‚æœæç¤ºéœ€è¦ï¼Œæ·»åŠ åˆ° PATH
+[Environment]::SetEnvironmentVariable('Path', "$env:Path;$env:APPDATA\Scripts", 'User')
+```
+
+> **ğŸ“– Windows ç”¨æˆ·**: è¯¦è§ [WINDOWS_INSTALL.md](WINDOWS_INSTALL.md) å®Œæ•´å®‰è£…æŒ‡å—
+
 
 
 
Index: bin/cask
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/bin/cask b/bin/cask
--- a/bin/cask	(revision acdb42e15193d62398f6460571f21a07a82ec921)
+++ b/bin/cask	(date 1766020886046)
@@ -9,8 +9,32 @@
 from pathlib import Path
 from typing import Optional, Tuple
 
-script_dir = Path(__file__).resolve().parent
-lib_dir = script_dir.parent / "lib"
+
+def _find_lib_dir() -> Path:
+    """æŸ¥æ‰¾ lib ç›®å½• (å…¼å®¹å„ç§å®‰è£…æ–¹å¼)"""
+    script_path = Path(__file__).resolve()
+
+    # æ–¹æ³•1: è„šæœ¬åœ¨ bin ç›®å½• (å¼€å‘ç¯å¢ƒ/Unix å®‰è£…)
+    candidate = script_path.parent.parent / "lib"
+    if candidate.is_dir() and (candidate / "terminal.py").exists():
+        return candidate
+
+    # æ–¹æ³•2: Windows å®‰è£… (Scripts ç›®å½•)
+    if os.environ.get("APPDATA"):
+        candidate = Path(os.environ["APPDATA"]) / "codex-dual" / "lib"
+        if candidate.is_dir() and (candidate / "terminal.py").exists():
+            return candidate
+
+    # æ–¹æ³•3: Unix æ ‡å‡†å®‰è£…ä½ç½®
+    candidate = Path.home() / ".local" / "share" / "codex-dual" / "lib"
+    if candidate.is_dir() and (candidate / "terminal.py").exists():
+        return candidate
+
+    # å¦‚æœéƒ½æ‰¾ä¸åˆ°ï¼Œè¿”å›é»˜è®¤è·¯å¾„
+    return script_path.parent.parent / "lib"
+
+
+lib_dir = _find_lib_dir()
 sys.path.insert(0, str(lib_dir))
 
 from terminal import get_backend_for_session, get_pane_id_from_session
Index: lib/terminal.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/lib/terminal.py b/lib/terminal.py
--- a/lib/terminal.py	(revision acdb42e15193d62398f6460571f21a07a82ec921)
+++ b/lib/terminal.py	(date 1766019648024)
@@ -135,7 +135,16 @@
         args.extend(["--percent", str(percent)])
         if parent_pane:
             args.extend(["--pane-id", parent_pane])
-        args.extend(["--", "bash", "-c", cmd])
+
+        # æ ¹æ®å¹³å°é€‰æ‹© Shell
+        import platform
+        if platform.system() == "Windows" and not os.environ.get("WSL_DISTRO_NAME"):
+            # Windows åŸç”Ÿ: ä½¿ç”¨ PowerShell
+            args.extend(["--", "powershell.exe", "-NoProfile", "-Command", cmd])
+        else:
+            # Unix-like æˆ– WSL: ä½¿ç”¨ bash
+            args.extend(["--", "bash", "-c", cmd])
+
         result = subprocess.run(args, capture_output=True, text=True, check=True)
         return result.stdout.strip()
 
Index: ccb
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ccb b/ccb
--- a/ccb	(revision acdb42e15193d62398f6460571f21a07a82ec921)
+++ b/ccb	(date 1766020860065)
@@ -20,13 +20,50 @@
 import re
 from pathlib import Path
 
-script_dir = Path(__file__).resolve().parent
-sys.path.insert(0, str(script_dir / "lib"))
+
+def _find_lib_dir() -> Path:
+    """æŸ¥æ‰¾ lib ç›®å½• (å…¼å®¹å„ç§å®‰è£…æ–¹å¼)"""
+    script_path = Path(__file__).resolve()
+
+    # æ–¹æ³•1: è„šæœ¬åœ¨é¡¹ç›®æ ¹ç›®å½• (å¼€å‘ç¯å¢ƒ)
+    # ç»“æ„: é¡¹ç›®æ ¹/ccb, é¡¹ç›®æ ¹/lib/
+    candidate = script_path.parent / "lib"
+    if candidate.is_dir() and (candidate / "terminal.py").exists():
+        return candidate
+
+    # æ–¹æ³•2: è„šæœ¬åœ¨ bin ç›®å½• (Unix å®‰è£…)
+    # ç»“æ„: å®‰è£…æ ¹/bin/ccb, å®‰è£…æ ¹/lib/
+    candidate = script_path.parent.parent / "lib"
+    if candidate.is_dir() and (candidate / "terminal.py").exists():
+        return candidate
+
+    # æ–¹æ³•3: Windows å®‰è£… (é€šè¿‡ç¯å¢ƒå˜é‡)
+    # Scripts/ccb.py -> APPDATA/codex-dual/lib
+    if os.environ.get("APPDATA"):
+        candidate = Path(os.environ["APPDATA"]) / "codex-dual" / "lib"
+        if candidate.is_dir() and (candidate / "terminal.py").exists():
+            return candidate
+
+    # æ–¹æ³•4: Unix å®‰è£… (é€šè¿‡ HOME)
+    candidate = Path.home() / ".local" / "share" / "codex-dual" / "lib"
+    if candidate.is_dir() and (candidate / "terminal.py").exists():
+        return candidate
+
+    # å¦‚æœéƒ½æ‰¾ä¸åˆ°ï¼Œè¿”å›é»˜è®¤è·¯å¾„ (ä¼šæŠ¥é”™)
+    return script_path.parent / "lib"
+
+
+lib_dir = _find_lib_dir()
+sys.path.insert(0, str(lib_dir))
 from terminal import TmuxBackend, WeztermBackend, detect_terminal
 
 
 def is_wsl() -> bool:
     try:
+        # Windows åŸç”Ÿç›´æ¥è¿”å› False (é¿å…è®¿é—®ä¸å­˜åœ¨çš„ /proc/version)
+        if platform.system() == "Windows":
+            return False
+        # WSL ç¯å¢ƒæ£€æŸ¥ /proc/version
         return "microsoft" in Path("/proc/version").read_text().lower()
     except Exception:
         return False
@@ -50,6 +87,11 @@
         self.processes = {}
 
     def _detect_terminal_type(self):
+        # Windows åŸç”Ÿå¼ºåˆ¶ä½¿ç”¨ WezTerm (ä¸æ”¯æŒ tmux)
+        if platform.system() == "Windows" and not os.environ.get("WSL_DISTRO_NAME"):
+            return "wezterm"
+
+        # å…¶ä»–ç³»ç»Ÿä¿æŒåŸé€»è¾‘
         # åªæœ‰åœ¨ WezTerm ç¯å¢ƒä¸­æ‰ç”¨ WezTerm åˆ†å±
         if os.environ.get("WEZTERM_PANE"):
             return "wezterm"
Index: WINDOWS_INSTALL.md
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/WINDOWS_INSTALL.md b/WINDOWS_INSTALL.md
new file mode 100644
--- /dev/null	(date 1766022490296)
+++ b/WINDOWS_INSTALL.md	(date 1766022490296)
@@ -0,0 +1,416 @@
+# Windows å®‰è£…æŒ‡å—
+
+> Claude Code Bridge (ccb) - Windows 10/11 åŸç”Ÿæ”¯æŒ
+
+## ğŸ“‹ å‰ç½®è¦æ±‚
+
+### å¿…éœ€
+- **Windows 10 æˆ– Windows 11**
+- **Python 3.8+** (æ¨è Python 3.10+)
+  - ä¸‹è½½: https://www.python.org/downloads/
+  - å®‰è£…æ—¶å‹¾é€‰ "Add Python to PATH"
+- **WezTerm** (æ¨èçš„ç»ˆç«¯æ¨¡æ‹Ÿå™¨)
+  - ä¸‹è½½: https://wezfurlong.org/wezterm/
+  - æˆ–ä½¿ç”¨ `winget install wez.wezterm`
+
+### å½“å‰ç³»ç»ŸçŠ¶æ€
+âœ… Python 3.13.3 å·²å®‰è£…
+âœ… WezTerm å·²å®‰è£…
+
+---
+
+## ğŸš€ å¿«é€Ÿå®‰è£…
+
+### æ–¹æ³• 1: PowerShell (æ¨è)
+
+åœ¨é¡¹ç›®ç›®å½•ä¸­æ‰“å¼€ PowerShell:
+
+```powershell
+# è¿›å…¥é¡¹ç›®ç›®å½•
+cd D:\workspace\IdeaProjects\claude_code_bridge
+
+# æ‰§è¡Œå®‰è£…
+.\install.ps1 install
+```
+
+### æ–¹æ³• 2: Git Bash
+
+å¦‚æœä½ å®‰è£…äº† Git for Windows:
+
+```bash
+./install.sh install
+```
+
+---
+
+## âš™ï¸ é…ç½® PATH
+
+å®‰è£…å®Œæˆå,éœ€è¦å°†å¯æ‰§è¡Œç›®å½•æ·»åŠ åˆ° PATH ç¯å¢ƒå˜é‡ã€‚
+
+### è‡ªåŠ¨é…ç½® (æ¨è)
+
+å®‰è£…è„šæœ¬ä¼šè¯¢é—®æ˜¯å¦è‡ªåŠ¨æ·»åŠ åˆ° PATH,é€‰æ‹© `y` å³å¯ã€‚
+
+### æ‰‹åŠ¨é…ç½®
+
+å¦‚æœè‡ªåŠ¨é…ç½®å¤±è´¥,è¯·æ‰‹åŠ¨æ·»åŠ :
+
+**æ–¹æ³• 1: PowerShell å‘½ä»¤**
+```powershell
+$binDir = "$env:APPDATA\Scripts"
+[Environment]::SetEnvironmentVariable('Path', "$env:Path;$binDir", 'User')
+```
+
+**æ–¹æ³• 2: å›¾å½¢ç•Œé¢**
+1. å³é”® "æ­¤ç”µè„‘" â†’ "å±æ€§"
+2. ç‚¹å‡» "é«˜çº§ç³»ç»Ÿè®¾ç½®"
+3. ç‚¹å‡» "ç¯å¢ƒå˜é‡"
+4. åœ¨ "ç”¨æˆ·å˜é‡" ä¸­æ‰¾åˆ° "Path",ç‚¹å‡» "ç¼–è¾‘"
+5. ç‚¹å‡» "æ–°å»º",æ·»åŠ : `C:\Users\ä½ çš„ç”¨æˆ·å\AppData\Roaming\Scripts`
+6. ç‚¹å‡» "ç¡®å®š" ä¿å­˜
+
+### éªŒè¯ PATH é…ç½®
+
+é‡å¯ç»ˆç«¯å,è¿è¡Œ:
+```powershell
+ccb --help
+```
+
+å¦‚æœæ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯,è¯´æ˜é…ç½®æˆåŠŸ âœ…
+
+---
+
+## ğŸ¯ ä½¿ç”¨æŒ‡å—
+
+### å¯åŠ¨ AI åç«¯
+
+åœ¨ **WezTerm** ä¸­è¿è¡Œ:
+
+```powershell
+# å¯åŠ¨ Codex
+ccb up codex
+
+# å¯åŠ¨ Gemini
+ccb up gemini
+
+# åŒæ—¶å¯åŠ¨ä¸¤ä¸ªåç«¯
+ccb up codex gemini
+```
+
+### é€šä¿¡å‘½ä»¤
+
+åœ¨ **Claude Code** ä¸­ä½¿ç”¨:
+
+#### Codex é€šä¿¡
+```bash
+# åŒæ­¥è¯¢é—® (ç­‰å¾…å›å¤)
+cask-w "å¸®æˆ‘åˆ†æè¿™æ®µä»£ç "
+
+# å¼‚æ­¥å‘é€ (ä¸ç­‰å¾…)
+cask "è¯·æŸ¥çœ‹æœ€æ–°çš„ commit"
+
+# æŸ¥çœ‹æœ€æ–°å›å¤
+cpend
+
+# æµ‹è¯•è¿é€šæ€§
+cping
+```
+
+#### Gemini é€šä¿¡
+```bash
+# åŒæ­¥è¯¢é—®
+gask-w "è¿™ä¸ªæ¶æ„è®¾è®¡å¦‚ä½•?"
+
+# å¼‚æ­¥å‘é€
+gask "è¯·å¸®æˆ‘reviewä»£ç "
+
+# æŸ¥çœ‹æœ€æ–°å›å¤
+gpend
+
+# æµ‹è¯•è¿é€šæ€§
+gping
+```
+
+### æ£€æŸ¥çŠ¶æ€
+
+```powershell
+# æŸ¥çœ‹æ‰€æœ‰åç«¯çŠ¶æ€
+ccb status
+
+# æŸ¥çœ‹ç‰¹å®šåç«¯
+ccb status codex
+ccb status gemini
+```
+
+### ç»ˆæ­¢ä¼šè¯
+
+```powershell
+# ç»ˆæ­¢æ‰€æœ‰åç«¯
+ccb kill
+
+# ç»ˆæ­¢ç‰¹å®šåç«¯
+ccb kill codex
+ccb kill gemini
+```
+
+### æ¢å¤ä¼šè¯
+
+```powershell
+# æ¢å¤ä¹‹å‰çš„ä¼šè¯
+ccb restore codex
+ccb restore gemini
+```
+
+---
+
+## ğŸš Git Bash / WSL æ”¯æŒ
+
+### è‡ªåŠ¨ç”Ÿæˆçš„ Shell Wrapper
+
+**ä» v2.1 å¼€å§‹**ï¼Œå®‰è£…å™¨ä¼šè‡ªåŠ¨ä¸º Git Bash ç”Ÿæˆæ— æ‰©å±•åçš„ shell wrapperï¼Œæ— éœ€é¢å¤–é…ç½®å³å¯ä½¿ç”¨ã€‚
+
+```bash
+# éªŒè¯ wrapper æ˜¯å¦å­˜åœ¨
+ls -l "$APPDATA/Scripts/cask-w"
+# è¾“å‡ºï¼š-rwxr-xr-x 1 user group ... cask-w
+
+# ç›´æ¥ä½¿ç”¨ï¼ˆæ— éœ€ .bat åç¼€ï¼‰
+cask-w "ä½ çš„é—®é¢˜"
+cpend
+cping
+```
+
+### æ•…éšœæ’é™¤
+
+**é—®é¢˜ 1ï¼šå‘½ä»¤ä»ç„¶æ‰¾ä¸åˆ°**
+
+åŸå› ï¼šScripts ç›®å½•ä¸åœ¨ PATH ä¸­
+
+è§£å†³æ–¹æ¡ˆï¼š
+```bash
+# ä¸´æ—¶æ·»åŠ ï¼ˆå½“å‰ä¼šè¯ï¼‰
+export PATH="/c/Users/ä½ çš„ç”¨æˆ·å/AppData/Roaming/Scripts:$PATH"
+
+# æ°¸ä¹…æ·»åŠ ï¼ˆæ¨èï¼‰
+echo 'export PATH="$APPDATA/Scripts:$PATH"' >> ~/.bashrc
+source ~/.bashrc
+```
+
+**é—®é¢˜ 2ï¼šæƒé™è¢«æ‹’ç»**
+
+åŸå› ï¼šwrapper ç¼ºå°‘æ‰§è¡Œæƒé™
+
+è§£å†³æ–¹æ¡ˆï¼š
+```bash
+chmod +x "$APPDATA/Scripts"/*
+```
+
+**é—®é¢˜ 3ï¼šä»æ—§ç‰ˆæœ¬å‡çº§**
+
+å¦‚æœä» v2.0 å‡çº§ï¼Œé‡æ–°è¿è¡Œå®‰è£…è„šæœ¬ï¼š
+
+```powershell
+# PowerShell
+cd claude_code_bridge
+.\install.ps1 install
+```
+
+### WSL ç”¨æˆ·
+
+WSL ç¯å¢ƒè¯·ä½¿ç”¨ Linux å®‰è£…æ–¹å¼ï¼š
+
+```bash
+cd ~/claude_code_bridge
+./install.sh install
+```
+
+---
+
+## ğŸ”§ æ•…éšœæ’é™¤
+
+### é—®é¢˜ 1: `ccb` å‘½ä»¤æ— æ³•è¯†åˆ«
+
+**åŸå› **: PATH æœªæ­£ç¡®é…ç½®æˆ–ç»ˆç«¯æœªé‡å¯
+
+**è§£å†³æ–¹æ¡ˆ**:
+1. é‡å¯ç»ˆç«¯ (å…³é—­æ‰€æœ‰ PowerShell/WezTerm çª—å£åé‡æ–°æ‰“å¼€)
+2. æ£€æŸ¥ PATH: `$env:Path -split ';' | Select-String 'Scripts'`
+3. å¦‚æœæ²¡æœ‰è¾“å‡º,æŒ‰ç…§ "é…ç½® PATH" ç« èŠ‚æ‰‹åŠ¨æ·»åŠ 
+
+---
+
+### é—®é¢˜ 2: Python æŠ¥é”™
+
+**åŸå› **: Python ç‰ˆæœ¬è¿‡ä½æˆ–æœªå®‰è£…
+
+**è§£å†³æ–¹æ¡ˆ**:
+1. æ£€æŸ¥ç‰ˆæœ¬: `python --version`
+2. å¦‚æœä½äº 3.8,ä» https://www.python.org/downloads/ ä¸‹è½½æ–°ç‰ˆæœ¬
+3. å®‰è£…æ—¶åŠ¡å¿…å‹¾é€‰ "Add Python to PATH"
+
+---
+
+### é—®é¢˜ 3: WezTerm æœªæ‰¾åˆ°
+
+**åŸå› **: WezTerm æœªå®‰è£…æˆ–ä¸åœ¨ PATH ä¸­
+
+**è§£å†³æ–¹æ¡ˆ**:
+1. å®‰è£… WezTerm: `winget install wez.wezterm`
+2. æˆ–æ‰‹åŠ¨ä¸‹è½½: https://wezfurlong.org/wezterm/
+3. å¦‚æœå·²å®‰è£…ä½†æœªæ£€æµ‹åˆ°,è®¾ç½®ç¯å¢ƒå˜é‡:
+   ```powershell
+   [Environment]::SetEnvironmentVariable('CODEX_WEZTERM_BIN', 'C:\Program Files\WezTerm\wezterm.exe', 'User')
+   ```
+
+---
+
+### é—®é¢˜ 4: PowerShell æ‰§è¡Œç­–ç•¥é™åˆ¶
+
+**é”™è¯¯æç¤º**: `æ— æ³•åŠ è½½æ–‡ä»¶ install.ps1,å› ä¸ºåœ¨æ­¤ç³»ç»Ÿä¸Šç¦æ­¢è¿è¡Œè„šæœ¬`
+
+**è§£å†³æ–¹æ¡ˆ**:
+1. ä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€ PowerShell
+2. è¿è¡Œ: `Set-ExecutionPolicy RemoteSigned -Scope CurrentUser`
+3. è¾“å…¥ `Y` ç¡®è®¤
+4. é‡æ–°æ‰§è¡Œå®‰è£…è„šæœ¬
+
+---
+
+### é—®é¢˜ 5: ä¸­æ–‡è·¯å¾„æˆ–ç”¨æˆ·åé—®é¢˜
+
+**ç°è±¡**: å®‰è£…æˆ–è¿è¡Œæ—¶å‡ºç°ç¼–ç é”™è¯¯
+
+**è§£å†³æ–¹æ¡ˆ**:
+- é¡¹ç›®å·²ä½¿ç”¨ UTF-8 ç¼–ç ,ç†è®ºä¸Šæ”¯æŒä¸­æ–‡è·¯å¾„
+- å¦‚æœä»æœ‰é—®é¢˜,å»ºè®®ä½¿ç”¨è‹±æ–‡è·¯å¾„
+- æˆ–å°†å®‰è£…ç›®å½•è®¾ç½®ä¸º: `.\install.ps1 -InstallPrefix "D:\ccb"`
+
+---
+
+### é—®é¢˜ 6: `ccb up codex` æ— ååº”
+
+**å¯èƒ½åŸå› **:
+1. ä¸åœ¨ WezTerm ä¸­è¿è¡Œ
+2. Codex æˆ– Gemini æœªå®‰è£…
+
+**è§£å†³æ–¹æ¡ˆ**:
+1. ç¡®ä¿åœ¨ WezTerm ç»ˆç«¯ä¸­è¿è¡Œ (ä¸è¦ç”¨ Windows Terminal æˆ– PowerShell ISE)
+2. æ£€æŸ¥ Codex å®‰è£…: `codex --version`
+3. æ£€æŸ¥ Gemini å®‰è£…: `gemini --version`
+
+---
+
+## ğŸ”„ æ›´æ–°
+
+### æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬
+
+```powershell
+# Git æ›´æ–° (å¦‚æœæ˜¯ä» Git ä»“åº“å®‰è£…)
+cd D:\workspace\IdeaProjects\claude_code_bridge
+git pull
+.\install.ps1 update
+
+# æˆ–è€…é‡æ–°å®‰è£…
+.\install.ps1 install
+```
+
+---
+
+## ğŸ—‘ï¸ å¸è½½
+
+### å®Œå…¨å¸è½½
+
+```powershell
+cd D:\workspace\IdeaProjects\claude_code_bridge
+.\install.ps1 uninstall
+```
+
+**æ³¨æ„**: å¸è½½ä¸ä¼šåˆ é™¤ Claude é…ç½®æ–‡ä»¶ (`~\.claude\`)
+
+---
+
+## ğŸ“ æ–‡ä»¶ä½ç½®
+
+### å®‰è£…ç›®å½•
+- **å®‰è£…è·¯å¾„**: `C:\Users\ä½ çš„ç”¨æˆ·å\AppData\Roaming\codex-dual`
+- **å¯æ‰§è¡Œæ–‡ä»¶**: `C:\Users\ä½ çš„ç”¨æˆ·å\AppData\Roaming\Scripts`
+- **Claude é…ç½®**: `C:\Users\ä½ çš„ç”¨æˆ·å\.claude\`
+- **è¿è¡Œæ—¶ç›®å½•**: `%TEMP%\claude-ai-ä½ çš„ç”¨æˆ·å\`
+
+### ä¼šè¯æ–‡ä»¶
+- **é¡¹ç›®çº§ä¼šè¯**: `.codex-session`, `.gemini-session`
+- **Codex æ—¥å¿—**: `~\.codex\sessions\`
+- **Gemini æ—¥å¿—**: `~\.gemini\tmp\`
+
+---
+
+## ğŸ’¡ ä½¿ç”¨æŠ€å·§
+
+### 1. åœ¨ Claude ä¸­å¿«é€Ÿè§¦å‘
+
+Claude é…ç½®äº†å¿«æ·è§¦å‘è§„åˆ™:
+- `@codex é—®é¢˜` â†’ è‡ªåŠ¨æ‰§è¡Œ `cask-w "é—®é¢˜"`
+- `@gemini é—®é¢˜` â†’ è‡ªåŠ¨æ‰§è¡Œ `gask-w "é—®é¢˜"`
+- `è°ƒå–codex` â†’ ç«‹å³è§¦å‘
+- `é—®codex` â†’ ç«‹å³è§¦å‘
+
+### 2. WezTerm åˆ†å±å¸ƒå±€
+
+`ccb up` ä¼šè‡ªåŠ¨åœ¨ WezTerm ä¸­åˆ›å»ºåˆ†å±:
+- ç¬¬ä¸€ä¸ªåç«¯: å³ä¾§åˆ†å±
+- ç¬¬äºŒä¸ªåç«¯: ä¸‹æ–¹åˆ†å±
+
+ä½ å¯ä»¥ç”¨ `Ctrl+Shift+H/J/K/L` åœ¨çª—æ ¼é—´åˆ‡æ¢ (å¦‚æœé…ç½®äº†å¿«æ·é”®)
+
+### 3. ä¼šè¯æŒä¹…åŒ–
+
+ä¼šè¯ä¼šè‡ªåŠ¨ä¿å­˜åˆ°é¡¹ç›®ç›®å½•:
+- `.codex-session` - Codex ä¼šè¯ä¿¡æ¯
+- `.gemini-session` - Gemini ä¼šè¯ä¿¡æ¯
+
+å³ä½¿å…³é—­ç»ˆç«¯,ä¹Ÿå¯ä»¥ç”¨ `ccb restore` æ¢å¤
+
+### 4. å¤šé¡¹ç›®æ”¯æŒ
+
+æ¯ä¸ªé¡¹ç›®ç›®å½•å¯ä»¥ç‹¬ç«‹è¿è¡Œ ccb:
+```powershell
+cd D:\project-a
+ccb up codex
+
+cd D:\project-b
+ccb up codex  # ä¸ä¼šå†²çª
+```
+
+---
+
+## ğŸ†˜ è·å–å¸®åŠ©
+
+### å‘½ä»¤å¸®åŠ©
+```powershell
+ccb --help
+cask --help
+gask --help
+```
+
+### åœ¨çº¿èµ„æº
+- **é¡¹ç›®ä¸»é¡µ**: [GitHub - claude_code_bridge](https://github.com/your-repo/claude_code_bridge)
+- **é—®é¢˜åé¦ˆ**: [GitHub Issues](https://github.com/your-repo/claude_code_bridge/issues)
+- **ä¸» README**: [README.md](README.md)
+
+---
+
+## ğŸ‰ æˆåŠŸå®‰è£…å
+
+æ­å–œ!ä½ å·²ç»æˆåŠŸåœ¨ Windows ä¸Šå®‰è£…äº† Claude Code Bridgeã€‚
+
+**æ¨èå·¥ä½œæµ**:
+1. åœ¨ WezTerm ä¸­æ‰“å¼€ä½ çš„é¡¹ç›®ç›®å½•
+2. è¿è¡Œ `ccb up codex` (æˆ– `ccb up gemini`)
+3. åœ¨ Claude Code ä¸­ä½¿ç”¨ `cask-w` æˆ– `gask-w` ä¸ AI åä½œ
+4. äº«å—å¤š AI å¹¶è¡Œå·¥ä½œçš„é«˜æ•ˆä½“éªŒ!
+
+**æç¤º**: ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶,Codex å’Œ Gemini å¯èƒ½éœ€è¦ä½ æˆæƒæˆ–ç™»å½•,æŒ‰ç…§æç¤ºæ“ä½œå³å¯ã€‚
+
+---
+
+*æ–‡æ¡£ç‰ˆæœ¬: 2.1 | æœ€åæ›´æ–°: 2025*
Index: bin/gask-w
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/bin/gask-w b/bin/gask-w
--- a/bin/gask-w	(revision acdb42e15193d62398f6460571f21a07a82ec921)
+++ b/bin/gask-w	(date 1766020992732)
@@ -5,11 +5,28 @@
 
 from __future__ import annotations
 
+import os
 import sys
 from pathlib import Path
 
-script_dir = Path(__file__).resolve().parent
-lib_dir = script_dir.parent / "lib"
+
+def _find_lib_dir() -> Path:
+    """æŸ¥æ‰¾ lib ç›®å½• (å…¼å®¹å„ç§å®‰è£…æ–¹å¼)"""
+    script_path = Path(__file__).resolve()
+    candidate = script_path.parent.parent / "lib"
+    if candidate.is_dir() and (candidate / "terminal.py").exists():
+        return candidate
+    if os.environ.get("APPDATA"):
+        candidate = Path(os.environ["APPDATA"]) / "codex-dual" / "lib"
+        if candidate.is_dir() and (candidate / "terminal.py").exists():
+            return candidate
+    candidate = Path.home() / ".local" / "share" / "codex-dual" / "lib"
+    if candidate.is_dir() and (candidate / "terminal.py").exists():
+        return candidate
+    return script_path.parent.parent / "lib"
+
+
+lib_dir = _find_lib_dir()
 sys.path.insert(0, str(lib_dir))
 
 from gemini_comm import GeminiCommunicator
Index: bin/cask-w
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/bin/cask-w b/bin/cask-w
--- a/bin/cask-w	(revision acdb42e15193d62398f6460571f21a07a82ec921)
+++ b/bin/cask-w	(date 1766020960702)
@@ -3,11 +3,28 @@
 cask-w - åŒæ­¥å‘é€æ¶ˆæ¯åˆ° Codex å¹¶ç­‰å¾…å›å¤
 """
 from __future__ import annotations
+import os
 import sys
 from pathlib import Path
 
-script_dir = Path(__file__).resolve().parent
-lib_dir = script_dir.parent / "lib"
+
+def _find_lib_dir() -> Path:
+    """æŸ¥æ‰¾ lib ç›®å½• (å…¼å®¹å„ç§å®‰è£…æ–¹å¼)"""
+    script_path = Path(__file__).resolve()
+    candidate = script_path.parent.parent / "lib"
+    if candidate.is_dir() and (candidate / "terminal.py").exists():
+        return candidate
+    if os.environ.get("APPDATA"):
+        candidate = Path(os.environ["APPDATA"]) / "codex-dual" / "lib"
+        if candidate.is_dir() and (candidate / "terminal.py").exists():
+            return candidate
+    candidate = Path.home() / ".local" / "share" / "codex-dual" / "lib"
+    if candidate.is_dir() and (candidate / "terminal.py").exists():
+        return candidate
+    return script_path.parent.parent / "lib"
+
+
+lib_dir = _find_lib_dir()
 sys.path.insert(0, str(lib_dir))
 
 from codex_comm import CodexCommunicator
Index: install.ps1
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/install.ps1 b/install.ps1
new file mode 100644
--- /dev/null	(date 1766022454046)
+++ b/install.ps1	(date 1766022454046)
@@ -0,0 +1,315 @@
+# Claude Code Bridge (ccb) Windows å®‰è£…è„šæœ¬
+# ç‰ˆæœ¬: 2.1-windows
+# æ”¯æŒ: Windows 10+
+
+param(
+    [Parameter(Position=0)]
+    [ValidateSet("install", "uninstall", "update")]
+    [string]$Action = "install",
+
+    [string]$InstallPrefix = "$env:APPDATA\codex-dual",
+    [string]$BinDir = "$env:APPDATA\Scripts"
+)
+
+$ErrorActionPreference = "Stop"
+
+# é¢œè‰²è¾“å‡ºå‡½æ•°
+function Write-ColorOutput {
+    param(
+        [string]$Message,
+        [string]$Color = "White"
+    )
+    Write-Host $Message -ForegroundColor $Color
+}
+
+# æ£€æŸ¥ Python ç‰ˆæœ¬
+function Test-PythonVersion {
+    Write-ColorOutput "`nğŸ” æ£€æŸ¥ Python..." "Cyan"
+
+    $pythonCmd = $null
+
+    # ä¼˜å…ˆä½¿ç”¨ py launcher
+    if (Get-Command py -ErrorAction SilentlyContinue) {
+        $pythonCmd = "py"
+    }
+    elseif (Get-Command python -ErrorAction SilentlyContinue) {
+        $pythonCmd = "python"
+    }
+    elseif (Get-Command python3 -ErrorAction SilentlyContinue) {
+        $pythonCmd = "python3"
+    }
+    else {
+        Write-ColorOutput "âŒ æœªæ‰¾åˆ° Python" "Red"
+        Write-ColorOutput "   è¯·ä» https://www.python.org/downloads/ å®‰è£… Python 3.8+" "Yellow"
+        exit 1
+    }
+
+    # æ£€æŸ¥ç‰ˆæœ¬
+    try {
+        $versionOutput = & $pythonCmd -c "import sys; print(f'{sys.version_info.major}.{sys.version_info.minor}')"
+
+        # åˆ†åˆ«è·å–ä¸»ç‰ˆæœ¬å·å’Œæ¬¡ç‰ˆæœ¬å·è¿›è¡Œæ¯”è¾ƒ
+        $parts = $versionOutput.Split('.')
+        $major = [int]$parts[0]
+        $minor = [int]$parts[1]
+
+        # æ£€æŸ¥æ˜¯å¦æ»¡è¶³ Python 3.8+ è¦æ±‚
+        if (($major -lt 3) -or (($major -eq 3) -and ($minor -lt 8))) {
+            Write-ColorOutput "âŒ Python ç‰ˆæœ¬è¿‡ä½: $versionOutput" "Red"
+            Write-ColorOutput "   éœ€è¦ Python 3.8+ï¼Œè¯·å‡çº§" "Yellow"
+            exit 1
+        }
+
+        Write-ColorOutput "âœ“ Python $versionOutput" "Green"
+        return $pythonCmd
+    }
+    catch {
+        Write-ColorOutput "âŒ æ— æ³•æ£€æµ‹ Python ç‰ˆæœ¬" "Red"
+        exit 1
+    }
+}
+
+# æ£€æŸ¥ WezTerm
+function Test-WezTerm {
+    Write-ColorOutput "ğŸ” æ£€æŸ¥ WezTerm..." "Cyan"
+
+    # æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®
+    $weztermBin = $env:CODEX_WEZTERM_BIN
+    if ($null -eq $weztermBin) {
+        $weztermBin = $env:WEZTERM_BIN
+    }
+
+    # å¦‚æœæŒ‡å®šäº†è·¯å¾„ï¼Œæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
+    if ($null -ne $weztermBin) {
+        if (Test-Path $weztermBin) {
+            Write-ColorOutput "âœ“ WezTerm å·²é…ç½®: $weztermBin" "Green"
+            return
+        }
+    }
+
+    # å°è¯•åœ¨ PATH ä¸­æŸ¥æ‰¾
+    if (Get-Command wezterm -ErrorAction SilentlyContinue) {
+        Write-ColorOutput "âœ“ WezTerm å·²å®‰è£…" "Green"
+        return
+    }
+
+    # æ£€æŸ¥å¸¸è§å®‰è£…ä½ç½®
+    $commonPaths = @(
+        "$env:ProgramFiles\WezTerm\wezterm.exe",
+        "$env:LOCALAPPDATA\WezTerm\wezterm.exe"
+    )
+
+    foreach ($path in $commonPaths) {
+        if (Test-Path $path) {
+            Write-ColorOutput "âœ“ WezTerm å·²å®‰è£…: $path" "Green"
+            Write-ColorOutput "  æç¤º: å¯è®¾ç½®ç¯å¢ƒå˜é‡ CODEX_WEZTERM_BIN=$path" "Yellow"
+            return
+        }
+    }
+
+    # WezTerm æœªæ‰¾åˆ°ï¼Œç»™å‡ºè­¦å‘Šå’Œå»ºè®®
+    Write-ColorOutput "âš ï¸  æœªæ£€æµ‹åˆ° WezTerm" "Yellow"
+    Write-ColorOutput "   å¼ºçƒˆå»ºè®®å®‰è£… WezTerm: https://wezfurlong.org/wezterm/" "Yellow"
+    Write-ColorOutput "   æˆ–è€…ä½¿ç”¨ winget install wez.wezterm" "Yellow"
+
+    $continue = Read-Host "`næ˜¯å¦ç»§ç»­å®‰è£…? (y/N)"
+    if ($continue -ne "y" -and $continue -ne "Y") {
+        Write-ColorOutput "å®‰è£…å·²å–æ¶ˆ" "Yellow"
+        exit 0
+    }
+}
+
+# ä¸»å®‰è£…å‡½æ•°
+function Install-CCB {
+    param([string]$PythonCmd)
+
+    Write-ColorOutput "`nğŸš€ å¼€å§‹å®‰è£… Claude Code Bridge..." "Cyan"
+    Write-ColorOutput "   å®‰è£…ç›®å½•: $InstallPrefix" "Gray"
+    Write-ColorOutput "   å¯æ‰§è¡Œç›®å½•: $BinDir`n" "Gray"
+
+    # ç¡®ä¿ lib/installer.py å­˜åœ¨
+    $installerScript = Join-Path $PSScriptRoot "lib\installer.py"
+    if (-not (Test-Path $installerScript)) {
+        Write-ColorOutput "âŒ æ‰¾ä¸åˆ°å®‰è£…å™¨: $installerScript" "Red"
+        exit 1
+    }
+
+    # è°ƒç”¨ Python å®‰è£…å™¨
+    try {
+        & $PythonCmd $installerScript install `
+            --install-prefix $InstallPrefix `
+            --bin-dir $BinDir `
+            --platform windows
+
+        if ($LASTEXITCODE -ne 0) {
+            throw "Python å®‰è£…å™¨è¿”å›é”™è¯¯ä»£ç  $LASTEXITCODE"
+        }
+    }
+    catch {
+        Write-ColorOutput "`nâŒ å®‰è£…å¤±è´¥: $_" "Red"
+        exit 1
+    }
+
+    # æ£€æŸ¥ PATH é…ç½®
+    Write-ColorOutput "`nğŸ” æ£€æŸ¥ PATH é…ç½®..." "Cyan"
+
+    $currentPath = [Environment]::GetEnvironmentVariable("Path", "User")
+    $binDirResolved = [System.IO.Path]::GetFullPath($BinDir)
+
+    if ($currentPath -notlike "*$binDirResolved*") {
+        Write-ColorOutput "âš ï¸  å¯æ‰§è¡Œç›®å½•ä¸åœ¨ PATH ä¸­" "Yellow"
+        Write-ColorOutput "`nè¦æ·»åŠ åˆ° PATHï¼Œè¯·åœ¨ PowerShell ä¸­è¿è¡Œ:" "Yellow"
+        Write-ColorOutput "  [Environment]::SetEnvironmentVariable('Path', `$env:Path + ';$binDirResolved', 'User')" "White"
+        Write-ColorOutput "`næˆ–è€…æ‰‹åŠ¨æ·»åŠ : ç³»ç»Ÿè®¾ç½® â†’ ç¯å¢ƒå˜é‡ â†’ ç”¨æˆ·å˜é‡ â†’ Path â†’ ç¼–è¾‘ â†’ æ–°å»º" "Gray"
+        Write-ColorOutput "  æ·»åŠ : $binDirResolved`n" "White"
+
+        # Git Bash é…ç½®è¯´æ˜
+        Write-ColorOutput "ğŸ“ Git Bash ç”¨æˆ·é¢å¤–è¯´æ˜:" "Cyan"
+        Write-ColorOutput "  v2.1+ å·²è‡ªåŠ¨ç”Ÿæˆ Shell wrapperï¼Œæ”¯æŒ Git Bash ç›´æ¥ä½¿ç”¨" "Gray"
+        Write-ColorOutput "  å¦‚éœ€é…ç½® PATHï¼Œåœ¨ ~/.bashrc æ·»åŠ :" "Gray"
+        Write-ColorOutput "  export PATH=`"/c/Users/$env:USERNAME/AppData/Roaming/Scripts:`$PATH`"" "White"
+        Write-ColorOutput ""
+
+        $addPath = Read-Host "æ˜¯å¦ç°åœ¨è‡ªåŠ¨æ·»åŠ åˆ° PATH? (y/N)"
+        if ($addPath -eq "y" -or $addPath -eq "Y") {
+            try {
+                $newPath = "$currentPath;$binDirResolved"
+                [Environment]::SetEnvironmentVariable("Path", $newPath, "User")
+                $env:Path = "$env:Path;$binDirResolved"
+                Write-ColorOutput "âœ“ å·²æ·»åŠ åˆ° PATH" "Green"
+                Write-ColorOutput "  æ³¨æ„: å¯èƒ½éœ€è¦é‡å¯ç»ˆç«¯æ‰èƒ½ç”Ÿæ•ˆ" "Yellow"
+                Write-ColorOutput "  Git Bash ç”¨æˆ·éœ€æ‰‹åŠ¨é…ç½® ~/.bashrc" "Yellow"
+            }
+            catch {
+                Write-ColorOutput "âŒ è‡ªåŠ¨æ·»åŠ å¤±è´¥: $_" "Red"
+                Write-ColorOutput "   è¯·æ‰‹åŠ¨æ·»åŠ " "Yellow"
+            }
+        }
+    }
+    else {
+        Write-ColorOutput "âœ“ PATH é…ç½®æ­£ç¡®" "Green"
+        Write-ColorOutput "  Git Bash ç”¨æˆ·: Shell wrapper å·²ç”Ÿæˆï¼Œå¯ç›´æ¥ä½¿ç”¨" "Gray"
+    }
+
+    # å®‰è£…å®Œæˆ
+    Write-ColorOutput "`nâœ… å®‰è£…å®Œæˆ!" "Green"
+    Write-ColorOutput "`nå¿«é€Ÿå¼€å§‹:" "Cyan"
+    Write-ColorOutput "  1. é‡å¯ç»ˆç«¯ (å¦‚æœä¿®æ”¹äº† PATH)" "White"
+    Write-ColorOutput "  2. åœ¨ WezTerm ä¸­è¿è¡Œ: ccb up codex" "White"
+    Write-ColorOutput "  3. åœ¨ Claude ä¸­ä½¿ç”¨: cask `"ä½ çš„é—®é¢˜`"" "White"
+    Write-ColorOutput "`nè¯¦ç»†æ–‡æ¡£: WINDOWS_INSTALL.md" "Gray"
+}
+
+# å¸è½½å‡½æ•°
+function Uninstall-CCB {
+    param([string]$PythonCmd)
+
+    Write-ColorOutput "`nğŸ—‘ï¸  å¼€å§‹å¸è½½ Claude Code Bridge..." "Cyan"
+
+    $installerScript = Join-Path $PSScriptRoot "lib\installer.py"
+    if (-not (Test-Path $installerScript)) {
+        Write-ColorOutput "âš ï¸  æ‰¾ä¸åˆ°å®‰è£…å™¨ï¼Œå°†æ‰‹åŠ¨æ¸…ç†" "Yellow"
+
+        # æ‰‹åŠ¨åˆ é™¤æ–‡ä»¶
+        if (Test-Path $InstallPrefix) {
+            Remove-Item -Recurse -Force $InstallPrefix
+            Write-ColorOutput "âœ“ å·²åˆ é™¤: $InstallPrefix" "Green"
+        }
+
+        # åˆ é™¤å¯æ‰§è¡Œæ–‡ä»¶
+        $scripts = @("ccb", "cask", "cask-w", "cpend", "cping", "gask", "gask-w", "gpend", "gping")
+        foreach ($script in $scripts) {
+            $batFile = Join-Path $BinDir "$script.bat"
+            $pyFile = Join-Path $BinDir "$script.py"
+
+            if (Test-Path $batFile) { Remove-Item -Force $batFile }
+            if (Test-Path $pyFile) { Remove-Item -Force $pyFile }
+        }
+
+        Write-ColorOutput "âœ“ å·²åˆ é™¤å¯æ‰§è¡Œæ–‡ä»¶" "Green"
+    }
+    else {
+        # ä½¿ç”¨ Python å®‰è£…å™¨å¸è½½
+        try {
+            & $PythonCmd $installerScript uninstall `
+                --install-prefix $InstallPrefix `
+                --bin-dir $BinDir `
+                --platform windows
+
+            if ($LASTEXITCODE -ne 0) {
+                throw "Python å¸è½½å™¨è¿”å›é”™è¯¯ä»£ç  $LASTEXITCODE"
+            }
+        }
+        catch {
+            Write-ColorOutput "`nâŒ å¸è½½å¤±è´¥: $_" "Red"
+            exit 1
+        }
+    }
+
+    Write-ColorOutput "`nâœ… å¸è½½å®Œæˆ!" "Green"
+    Write-ColorOutput "   æ³¨æ„: Claude é…ç½®æ–‡ä»¶ (~\.claude\) æœªè¢«åˆ é™¤" "Gray"
+}
+
+# æ›´æ–°å‡½æ•°
+function Update-CCB {
+    param([string]$PythonCmd)
+
+    Write-ColorOutput "`nğŸ”„ æ›´æ–° Claude Code Bridge..." "Cyan"
+
+    # æ£€æŸ¥æ˜¯å¦åœ¨ git ä»“åº“ä¸­
+    if (Test-Path (Join-Path $PSScriptRoot ".git")) {
+        Write-ColorOutput "æ£€æµ‹åˆ° Git ä»“åº“ï¼Œæ‰§è¡Œ git pull..." "Gray"
+
+        try {
+            $gitOutput = git -C $PSScriptRoot pull
+            Write-ColorOutput $gitOutput "Gray"
+        }
+        catch {
+            Write-ColorOutput "âš ï¸  Git pull å¤±è´¥: $_" "Yellow"
+            Write-ColorOutput "   ç»§ç»­æ‰§è¡Œå®‰è£…..." "Yellow"
+        }
+    }
+
+    # é‡æ–°å®‰è£…
+    Install-CCB -PythonCmd $PythonCmd
+}
+
+# ä¸»é€»è¾‘
+function Main {
+    Write-ColorOutput @"
+â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
+â•‘  Claude Code Bridge (ccb) - Windows å®‰è£…ç¨‹åº             â•‘
+â•‘  ç‰ˆæœ¬: 2.1-windows                                        â•‘
+â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+"@ "Cyan"
+
+    # æ£€æŸ¥ä¾èµ–
+    $pythonCmd = Test-PythonVersion
+
+    if ($Action -ne "uninstall") {
+        Test-WezTerm
+    }
+
+    # æ‰§è¡Œæ“ä½œ
+    switch ($Action) {
+        "install" {
+            Install-CCB -PythonCmd $pythonCmd
+        }
+        "uninstall" {
+            Uninstall-CCB -PythonCmd $pythonCmd
+        }
+        "update" {
+            Update-CCB -PythonCmd $pythonCmd
+        }
+    }
+}
+
+# æ‰§è¡Œä¸»å‡½æ•°
+try {
+    Main
+}
+catch {
+    Write-ColorOutput "`nâŒ å‘ç”Ÿé”™è¯¯: $_" "Red"
+    Write-ColorOutput $_.ScriptStackTrace "Gray"
+    exit 1
+}
Index: install.sh
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/install.sh b/install.sh
--- a/install.sh	(revision acdb42e15193d62398f6460571f21a07a82ec921)
+++ b/install.sh	(date 1766018323868)
@@ -1,4 +1,4 @@
-#!/usr/bin/env bash
+ #!/usr/bin/env bash
 set -euo pipefail
 
 REPO_ROOT="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
Index: lib/installer.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/lib/installer.py b/lib/installer.py
new file mode 100644
--- /dev/null	(date 1766022417772)
+++ b/lib/installer.py	(date 1766022417772)
@@ -0,0 +1,545 @@
+#!/usr/bin/env python3
+"""
+Claude Code Bridge (ccb) è·¨å¹³å°å®‰è£…å™¨æ ¸å¿ƒ
+æ”¯æŒ Windows / Linux / macOS
+
+ç‰ˆæœ¬: 2.1
+"""
+
+import argparse
+import json
+import os
+import platform
+import re
+import shutil
+import sys
+from pathlib import Path
+from typing import List, Optional
+
+
+class CCBInstaller:
+    """è·¨å¹³å°å®‰è£…å™¨æ ¸å¿ƒç±»"""
+
+    def __init__(
+        self,
+        repo_root: Path,
+        install_prefix: Path,
+        bin_dir: Path,
+        platform_name: Optional[str] = None
+    ):
+        self.repo_root = Path(repo_root).resolve()
+        self.install_prefix = Path(install_prefix).expanduser().resolve()
+        self.bin_dir = Path(bin_dir).expanduser().resolve()
+        self.platform = platform_name or self._detect_platform()
+
+        # éœ€è¦å®‰è£…çš„è„šæœ¬
+        self.scripts = [
+            "ccb",
+            "bin/cask",
+            "bin/cask-w",
+            "bin/cpend",
+            "bin/cping",
+            "bin/gask",
+            "bin/gask-w",
+            "bin/gpend",
+            "bin/gping"
+        ]
+
+        # Claude å‘½ä»¤æ–‡æ¡£
+        self.claude_commands = [
+            "cask.md",
+            "cask-w.md",
+            "cpend.md",
+            "cping.md",
+            "gask.md",
+            "gask-w.md",
+            "gpend.md",
+            "gping.md"
+        ]
+
+    def _detect_platform(self) -> str:
+        """æ£€æµ‹æ“ä½œç³»ç»Ÿå¹³å°"""
+        system = platform.system().lower()
+        if system == "windows":
+            return "windows"
+        elif system == "darwin":
+            return "macos"
+        else:
+            return "linux"
+
+    def install(self) -> None:
+        """ä¸»å®‰è£…æµç¨‹"""
+        print(f"ğŸš€ å¼€å§‹å®‰è£… (å¹³å°: {self.platform})")
+
+        self._check_dependencies()
+        self._copy_project()
+        self._install_scripts()
+        self._install_claude_commands()
+        self._configure_claude_md()
+        self._configure_settings_json()
+
+        print(f"âœ… å®‰è£…å®Œæˆ")
+        print(f"   å®‰è£…ç›®å½•: {self.install_prefix}")
+        print(f"   å¯æ‰§è¡Œç›®å½•: {self.bin_dir}")
+
+    def _check_dependencies(self) -> None:
+        """æ£€æŸ¥ä¾èµ–é¡¹"""
+        # Python ç‰ˆæœ¬æ£€æŸ¥
+        if sys.version_info < (3, 8):
+            raise RuntimeError(
+                f"éœ€è¦ Python 3.8+ï¼Œå½“å‰ç‰ˆæœ¬: "
+                f"{sys.version_info.major}.{sys.version_info.minor}"
+            )
+        print(f"âœ“ Python {sys.version_info.major}.{sys.version_info.minor}")
+
+        # WezTerm æ£€æŸ¥ (å¯é€‰ä½†æ¨è)
+        wezterm_bin = os.environ.get("CODEX_WEZTERM_BIN") or os.environ.get("WEZTERM_BIN")
+
+        if wezterm_bin and Path(wezterm_bin).exists():
+            print(f"âœ“ WezTerm å·²é…ç½®: {wezterm_bin}")
+        elif shutil.which("wezterm") or shutil.which("wezterm.exe"):
+            print("âœ“ WezTerm å·²å®‰è£…")
+        else:
+            print("âš ï¸  å»ºè®®å®‰è£… WezTerm: https://wezfurlong.org/wezterm/")
+
+    def _copy_project(self) -> None:
+        """å¤åˆ¶é¡¹ç›®æ–‡ä»¶åˆ°å®‰è£…ç›®å½•"""
+        print(f"ğŸ“¦ å¤åˆ¶é¡¹ç›®æ–‡ä»¶...")
+
+        # å¦‚æœå®‰è£…ç›®å½•å·²å­˜åœ¨ï¼Œå…ˆåˆ é™¤
+        if self.install_prefix.exists():
+            shutil.rmtree(self.install_prefix)
+
+        # åˆ›å»ºå®‰è£…ç›®å½•
+        self.install_prefix.mkdir(parents=True, exist_ok=True)
+
+        # éœ€è¦å¤åˆ¶çš„ç›®å½•å’Œæ–‡ä»¶
+        items_to_copy = ["ccb", "lib", "bin", "commands"]
+
+        for item in items_to_copy:
+            src = self.repo_root / item
+            dst = self.install_prefix / item
+
+            if not src.exists():
+                print(f"âš ï¸  è·³è¿‡ä¸å­˜åœ¨çš„é¡¹: {item}")
+                continue
+
+            if src.is_file():
+                # å¤åˆ¶å•ä¸ªæ–‡ä»¶
+                dst.parent.mkdir(parents=True, exist_ok=True)
+                shutil.copy2(src, dst)
+            elif src.is_dir():
+                # å¤åˆ¶æ•´ä¸ªç›®å½•
+                shutil.copytree(src, dst, dirs_exist_ok=True)
+
+        print(f"âœ“ é¡¹ç›®æ–‡ä»¶å·²å¤åˆ¶åˆ° {self.install_prefix}")
+
+    def _install_scripts(self) -> None:
+        """å®‰è£…å¯æ‰§è¡Œè„šæœ¬"""
+        print(f"ğŸ”§ å®‰è£…å¯æ‰§è¡Œè„šæœ¬...")
+
+        self.bin_dir.mkdir(parents=True, exist_ok=True)
+
+        if self.platform == "windows":
+            self._install_scripts_windows()
+        else:
+            self._install_scripts_unix()
+
+    def _generate_shell_wrapper(self, script_name: str, py_path: Path) -> str:
+        """ç”Ÿæˆ Git Bash å…¼å®¹çš„ shell wrapper"""
+        py_path_posix = py_path.as_posix()  # è½¬æ¢ä¸º POSIX è·¯å¾„
+
+        return f'''#!/usr/bin/env bash
+# {script_name} - Windows Git Bash wrapper
+# è‡ªåŠ¨ç”Ÿæˆï¼Œè¯·å‹¿æ‰‹åŠ¨ç¼–è¾‘
+
+set -euo pipefail
+
+# æ£€æµ‹è¿è¡Œç¯å¢ƒ
+if command -v py >/dev/null 2>&1; then
+    exec py "{py_path_posix}" "$@"
+elif command -v python3 >/dev/null 2>&1; then
+    exec python3 "{py_path_posix}" "$@"
+elif command -v python >/dev/null 2>&1; then
+    exec python "{py_path_posix}" "$@"
+else
+    echo "âŒ é”™è¯¯: æœªæ‰¾åˆ° Python è§£é‡Šå™¨" >&2
+    exit 1
+fi
+'''
+
+    def _install_scripts_windows(self) -> None:
+        """Windows è„šæœ¬å®‰è£… (å¤åˆ¶ + .bat wrapper)"""
+        # æ£€æŸ¥ py launcher
+        has_py_launcher = shutil.which("py") is not None
+        installed_count = 0
+
+        for script_path in self.scripts:
+            script_name = Path(script_path).name
+            src = self.install_prefix / script_path
+
+            if not src.exists():
+                print(f"âš ï¸  è·³è¿‡: {script_path} (æºæ–‡ä»¶ä¸å­˜åœ¨)")
+                continue
+
+            # å¤åˆ¶ Python è„šæœ¬ (é‡å‘½åä¸º .py)
+            py_dst = self.bin_dir / f"{script_name}.py"
+            shutil.copy2(src, py_dst)
+
+            # åˆ›å»º .bat wrapper
+            if has_py_launcher:
+                # ä½¿ç”¨ py launcher (æ¨è)
+                bat_content = f'@echo off\npy "%~dp0\\{script_name}.py" %*\n'
+            else:
+                # å›é€€åˆ° python å‘½ä»¤
+                bat_content = f'@echo off\npython "%~dp0\\{script_name}.py" %*\n'
+
+            bat_file = self.bin_dir / f"{script_name}.bat"
+            bat_file.write_text(bat_content, encoding="utf-8")
+
+            # 3. åˆ›å»º Shell wrapper (Git Bash/WSL)
+            sh_file = self.bin_dir / script_name  # æ— æ‰©å±•å
+            shell_content = self._generate_shell_wrapper(script_name, py_dst)
+            sh_file.write_text(shell_content, encoding="utf-8")
+
+            # è®¾ç½®æ‰§è¡Œæƒé™ï¼ˆGit Bash éœ€è¦ï¼‰
+            try:
+                import stat
+                os.chmod(sh_file, stat.S_IRWXU | stat.S_IRGRP | stat.S_IXGRP | stat.S_IROTH | stat.S_IXOTH)
+            except Exception as e:
+                print(f"âš ï¸  æ— æ³•è®¾ç½®æ‰§è¡Œæƒé™ {sh_file}: {e}")
+
+            installed_count += 1
+
+        print(f"âœ“ å·²å®‰è£… {installed_count} ä¸ªè„šæœ¬åˆ° {self.bin_dir}")
+        print(f"  æ ¼å¼: .bat (CMD/PowerShell) + shell wrapper (Git Bash)")
+
+    def _install_scripts_unix(self) -> None:
+        """Unix è„šæœ¬å®‰è£… (ç¬¦å·é“¾æ¥)"""
+        installed_count = 0
+
+        for script_path in self.scripts:
+            script_name = Path(script_path).name
+            src = self.install_prefix / script_path
+            dst = self.bin_dir / script_name
+
+            if not src.exists():
+                print(f"âš ï¸  è·³è¿‡: {script_path} (æºæ–‡ä»¶ä¸å­˜åœ¨)")
+                continue
+
+            # æ·»åŠ æ‰§è¡Œæƒé™
+            try:
+                os.chmod(src, 0o755)
+            except Exception as e:
+                print(f"âš ï¸  æ— æ³•è®¾ç½®æ‰§è¡Œæƒé™ {src}: {e}")
+
+            # åˆ›å»ºæˆ–æ›´æ–°ç¬¦å·é“¾æ¥
+            if dst.exists() or dst.is_symlink():
+                dst.unlink()
+
+            try:
+                dst.symlink_to(src)
+                installed_count += 1
+            except Exception as e:
+                print(f"âš ï¸  æ— æ³•åˆ›å»ºç¬¦å·é“¾æ¥ {dst}: {e}")
+
+        print(f"âœ“ å·²å®‰è£… {installed_count} ä¸ªè„šæœ¬åˆ° {self.bin_dir}")
+
+    def _install_claude_commands(self) -> None:
+        """å®‰è£… Claude å‘½ä»¤å®šä¹‰æ–‡ä»¶"""
+        print(f"ğŸ“ å®‰è£… Claude å‘½ä»¤...")
+
+        # æ£€æµ‹ Claude å‘½ä»¤ç›®å½•
+        claude_dir = self._detect_claude_dir()
+        claude_dir.mkdir(parents=True, exist_ok=True)
+
+        commands_src = self.repo_root / "commands"
+        if not commands_src.exists():
+            print(f"âš ï¸  å‘½ä»¤æºç›®å½•ä¸å­˜åœ¨: {commands_src}")
+            return
+
+        installed_count = 0
+        for cmd_file in self.claude_commands:
+            src = commands_src / cmd_file
+            dst = claude_dir / cmd_file
+
+            if src.exists():
+                shutil.copy2(src, dst)
+                installed_count += 1
+
+        print(f"âœ“ å·²å®‰è£… {installed_count} ä¸ª Claude å‘½ä»¤åˆ° {claude_dir}")
+
+    def _detect_claude_dir(self) -> Path:
+        """æ£€æµ‹ Claude å‘½ä»¤ç›®å½•"""
+        home = Path.home()
+
+        if self.platform == "windows":
+            # Windows è·¯å¾„å€™é€‰
+            candidates = [
+                home / ".claude" / "commands",
+                Path(os.environ.get("APPDATA", home)) / ".claude" / "commands"
+            ]
+        else:
+            # Unix è·¯å¾„å€™é€‰
+            candidates = [
+                home / ".claude" / "commands",
+                home / ".config" / "claude" / "commands",
+                home / ".local" / "share" / "claude" / "commands"
+            ]
+
+        # è¿”å›ç¬¬ä¸€ä¸ªå­˜åœ¨çš„ç›®å½•
+        for candidate in candidates:
+            if candidate.exists():
+                return candidate
+
+        # å¦‚æœéƒ½ä¸å­˜åœ¨ï¼Œè¿”å›é»˜è®¤ä½ç½®
+        return home / ".claude" / "commands"
+
+    def _configure_claude_md(self) -> None:
+        """é…ç½® CLAUDE.md å…¨å±€åä½œè§„åˆ™"""
+        print(f"ğŸ”§ é…ç½® Claude åä½œè§„åˆ™...")
+
+        home = Path.home()
+        claude_md = home / ".claude" / "CLAUDE.md"
+        claude_md.parent.mkdir(parents=True, exist_ok=True)
+
+        # è¯»å–ç°æœ‰å†…å®¹
+        if claude_md.exists():
+            content = claude_md.read_text(encoding="utf-8")
+        else:
+            content = ""
+
+        # ç§»é™¤æ—§çš„åä½œè§„åˆ™
+        patterns = [
+            r'## Codex Collaboration Rules.*?(?=\n## |\Z)',
+            r'## Codex åä½œè§„åˆ™.*?(?=\n## |\Z)',
+            r'## Gemini Collaboration Rules.*?(?=\n## |\Z)',
+            r'## Gemini åä½œè§„åˆ™.*?(?=\n## |\Z)',
+        ]
+
+        for pattern in patterns:
+            content = re.sub(pattern, '', content, flags=re.DOTALL)
+
+        # æ·»åŠ æ–°çš„åä½œè§„åˆ™
+        rules = """
+## Codex Collaboration Rules
+Codex is another AI assistant running via tmux. When user intent involves asking/consulting/collaborating with Codex:
+
+Fast path (minimize latency):
+- If the user message starts with any of: `è°ƒå–codex`, `@codex`, `codex:`, `codexï¼š`, `é—®codex`, `è®©codex` then immediately run:
+  - `cask-w "<rest of the message after the prefix>"` (no extra analysis, no pre-checks like cping)
+- If user message is only the prefix (no content), ask a 1-line clarification for what to send.
+
+Trigger conditions (any match):
+- User mentions codex/Codex with questioning/requesting tone
+- User wants codex to do something, give advice, or help review
+- User asks about codex's status or previous reply
+
+Command selection:
+- Default ask/collaborate â†’ `cask-w "<question>"` (sync, waits for reply)
+- Send without waiting â†’ `cask "<question>"` (async, returns immediately)
+- Check connectivity â†’ `cping`
+- View previous reply â†’ `cpend`
+
+Examples:
+- "what does codex think" â†’ cask-w
+- "ask codex to review this" â†’ cask-w
+- "is codex alive" â†’ cping
+- "don't wait for reply" â†’ cask
+
+## Gemini Collaboration Rules
+Gemini is another AI assistant running via tmux. When user intent involves asking/consulting/collaborating with Gemini:
+
+Fast path (minimize latency):
+- If the user message starts with any of: `è°ƒå–gemini`, `@gemini`, `gemini:`, `geminiï¼š`, `é—®gemini`, `è®©gemini` then immediately run:
+  - `gask-w "<rest of the message after the prefix>"` (no extra analysis, no pre-checks like gping)
+- If user message is only the prefix (no content), ask a 1-line clarification for what to send.
+
+Trigger conditions (any match):
+- User mentions gemini/Gemini with questioning/requesting tone
+- User wants gemini to do something, give advice, or help review
+- User asks about gemini's status or previous reply
+
+Command selection:
+- Default ask/collaborate â†’ `gask-w "<question>"` (sync, waits for reply)
+- Send without waiting â†’ `gask "<question>"` (async, returns immediately)
+- Check connectivity â†’ `gping`
+- View previous reply â†’ `gpend`
+
+Examples:
+- "what does gemini think" â†’ gask-w
+- "ask gemini to review this" â†’ gask-w
+- "is gemini alive" â†’ gping
+- "don't wait for reply" â†’ gask
+"""
+
+        # å†™å…¥é…ç½®
+        content = content.rstrip() + "\n" + rules
+        claude_md.write_text(content, encoding="utf-8")
+
+        print(f"âœ“ å·²æ›´æ–°: {claude_md}")
+
+    def _configure_settings_json(self) -> None:
+        """é…ç½® Claude settings.json æƒé™"""
+        print(f"ğŸ”§ é…ç½® Claude æƒé™...")
+
+        home = Path.home()
+        settings_file = home / ".claude" / "settings.json"
+        settings_file.parent.mkdir(parents=True, exist_ok=True)
+
+        # éœ€è¦æ·»åŠ çš„æƒé™
+        perms_to_add = [
+            'Bash(cask:*)',
+            'Bash(cask-w:*)',
+            'Bash(cpend)',
+            'Bash(cping)',
+            'Bash(gask:*)',
+            'Bash(gask-w:*)',
+            'Bash(gpend)',
+            'Bash(gping)'
+        ]
+
+        # è¯»å–æˆ–åˆ›å»ºé…ç½®
+        if settings_file.exists():
+            try:
+                data = json.loads(settings_file.read_text(encoding="utf-8"))
+            except json.JSONDecodeError:
+                print(f"âš ï¸  settings.json æ ¼å¼é”™è¯¯ï¼Œå°†é‡æ–°åˆ›å»º")
+                data = {}
+        else:
+            data = {}
+
+        # ç¡®ä¿æƒé™ç»“æ„å­˜åœ¨
+        if "permissions" not in data:
+            data["permissions"] = {"allow": [], "deny": []}
+        if "allow" not in data["permissions"]:
+            data["permissions"]["allow"] = []
+
+        # æ·»åŠ æƒé™ (å»é‡)
+        allow_list = data["permissions"]["allow"]
+        added_count = 0
+
+        for perm in perms_to_add:
+            if perm not in allow_list:
+                allow_list.append(perm)
+                added_count += 1
+
+        # å†™å›æ–‡ä»¶
+        settings_file.write_text(
+            json.dumps(data, indent=2, ensure_ascii=False),
+            encoding="utf-8"
+        )
+
+        print(f"âœ“ å·²æ·»åŠ  {added_count} ä¸ªæƒé™åˆ° {settings_file}")
+
+    def uninstall(self) -> None:
+        """å¸è½½"""
+        print("ğŸ—‘ï¸  å¼€å§‹å¸è½½...")
+
+        # åˆ é™¤å®‰è£…ç›®å½•
+        if self.install_prefix.exists():
+            shutil.rmtree(self.install_prefix)
+            print(f"âœ“ å·²åˆ é™¤: {self.install_prefix}")
+
+        # åˆ é™¤å¯æ‰§è¡Œæ–‡ä»¶
+        removed_count = 0
+        for script_path in self.scripts:
+            script_name = Path(script_path).name
+
+            if self.platform == "windows":
+                # Windows: åˆ é™¤ .py, .bat å’Œ shell wrapper
+                for ext in [".py", ".bat", ""]:  # æ–°å¢ç©ºå­—ç¬¦ä¸²ï¼ˆæ— æ‰©å±•å wrapperï¼‰
+                    file_path = self.bin_dir / f"{script_name}{ext}"
+                    if file_path.exists():
+                        file_path.unlink()
+                        removed_count += 1
+            else:
+                # Unix: åˆ é™¤ç¬¦å·é“¾æ¥
+                file_path = self.bin_dir / script_name
+                if file_path.exists() or file_path.is_symlink():
+                    file_path.unlink()
+                    removed_count += 1
+
+        print(f"âœ“ å·²åˆ é™¤ {removed_count} ä¸ªå¯æ‰§è¡Œæ–‡ä»¶")
+
+        # åˆ é™¤ Claude å‘½ä»¤ (å¯é€‰)
+        claude_dir = self._detect_claude_dir()
+        if claude_dir.exists():
+            removed_cmds = 0
+            for cmd_file in self.claude_commands:
+                file_path = claude_dir / cmd_file
+                if file_path.exists():
+                    file_path.unlink()
+                    removed_cmds += 1
+            print(f"âœ“ å·²åˆ é™¤ {removed_cmds} ä¸ª Claude å‘½ä»¤")
+
+        print("âœ… å¸è½½å®Œæˆ")
+        print(f"   æ³¨æ„: Claude é…ç½®æ–‡ä»¶ ({Path.home() / '.claude'}) æœªè¢«åˆ é™¤")
+
+
+def main():
+    """ä¸»å‡½æ•°"""
+    parser = argparse.ArgumentParser(
+        description="Claude Code Bridge (ccb) è·¨å¹³å°å®‰è£…å™¨",
+        formatter_class=argparse.RawDescriptionHelpFormatter
+    )
+
+    parser.add_argument(
+        "action",
+        choices=["install", "uninstall"],
+        help="æ‰§è¡Œçš„æ“ä½œ"
+    )
+    parser.add_argument(
+        "--install-prefix",
+        type=Path,
+        help="å®‰è£…ç›®å½•è·¯å¾„"
+    )
+    parser.add_argument(
+        "--bin-dir",
+        type=Path,
+        help="å¯æ‰§è¡Œæ–‡ä»¶ç›®å½•è·¯å¾„"
+    )
+    parser.add_argument(
+        "--platform",
+        choices=["windows", "linux", "macos"],
+        help="ç›®æ ‡å¹³å° (è‡ªåŠ¨æ£€æµ‹)"
+    )
+
+    args = parser.parse_args()
+
+    # ç¡®å®šè·¯å¾„
+    repo_root = Path(__file__).resolve().parent.parent
+
+    if args.platform == "windows":
+        install_prefix = args.install_prefix or Path(os.environ["APPDATA"]) / "codex-dual"
+        bin_dir = args.bin_dir or Path(os.environ["APPDATA"]) / "Scripts"
+    else:
+        install_prefix = args.install_prefix or Path.home() / ".local/share/codex-dual"
+        bin_dir = args.bin_dir or Path.home() / ".local/bin"
+
+    # åˆ›å»ºå®‰è£…å™¨å®ä¾‹
+    installer = CCBInstaller(
+        repo_root,
+        install_prefix,
+        bin_dir,
+        args.platform
+    )
+
+    # æ‰§è¡Œæ“ä½œ
+    try:
+        if args.action == "install":
+            installer.install()
+        else:
+            installer.uninstall()
+
+        sys.exit(0)
+
+    except Exception as e:
+        print(f"\nâŒ é”™è¯¯: {e}", file=sys.stderr)
+        import traceback
+        traceback.print_exc()
+        sys.exit(1)
+
+
+if __name__ == "__main__":
+    main()
Index: bin/gpend
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/bin/gpend b/bin/gpend
--- a/bin/gpend	(revision acdb42e15193d62398f6460571f21a07a82ec921)
+++ b/bin/gpend	(date 1766020993428)
@@ -3,11 +3,28 @@
 gpend - æŸ¥çœ‹ Gemini æœ€æ–°å›å¤
 """
 
+import os
 import sys
 from pathlib import Path
 
-script_dir = Path(__file__).resolve().parent
-lib_dir = script_dir.parent / "lib"
+
+def _find_lib_dir() -> Path:
+    """æŸ¥æ‰¾ lib ç›®å½• (å…¼å®¹å„ç§å®‰è£…æ–¹å¼)"""
+    script_path = Path(__file__).resolve()
+    candidate = script_path.parent.parent / "lib"
+    if candidate.is_dir() and (candidate / "terminal.py").exists():
+        return candidate
+    if os.environ.get("APPDATA"):
+        candidate = Path(os.environ["APPDATA"]) / "codex-dual" / "lib"
+        if candidate.is_dir() and (candidate / "terminal.py").exists():
+            return candidate
+    candidate = Path.home() / ".local" / "share" / "codex-dual" / "lib"
+    if candidate.is_dir() and (candidate / "terminal.py").exists():
+        return candidate
+    return script_path.parent.parent / "lib"
+
+
+lib_dir = _find_lib_dir()
 sys.path.insert(0, str(lib_dir))
 
 try:
Index: bin/cpend
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/bin/cpend b/bin/cpend
--- a/bin/cpend	(revision acdb42e15193d62398f6460571f21a07a82ec921)
+++ b/bin/cpend	(date 1766020961340)
@@ -4,11 +4,28 @@
 """
 
 import json
+import os
 import sys
 from pathlib import Path
 
-script_dir = Path(__file__).resolve().parent
-lib_dir = script_dir.parent / "lib"
+
+def _find_lib_dir() -> Path:
+    """æŸ¥æ‰¾ lib ç›®å½• (å…¼å®¹å„ç§å®‰è£…æ–¹å¼)"""
+    script_path = Path(__file__).resolve()
+    candidate = script_path.parent.parent / "lib"
+    if candidate.is_dir() and (candidate / "terminal.py").exists():
+        return candidate
+    if os.environ.get("APPDATA"):
+        candidate = Path(os.environ["APPDATA"]) / "codex-dual" / "lib"
+        if candidate.is_dir() and (candidate / "terminal.py").exists():
+            return candidate
+    candidate = Path.home() / ".local" / "share" / "codex-dual" / "lib"
+    if candidate.is_dir() and (candidate / "terminal.py").exists():
+        return candidate
+    return script_path.parent.parent / "lib"
+
+
+lib_dir = _find_lib_dir()
 sys.path.insert(0, str(lib_dir))
 
 try:
Index: bin/gask
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/bin/gask b/bin/gask
--- a/bin/gask	(revision acdb42e15193d62398f6460571f21a07a82ec921)
+++ b/bin/gask	(date 1766020962690)
@@ -5,11 +5,28 @@
 
 from __future__ import annotations
 
+import os
 import sys
 from pathlib import Path
 
-script_dir = Path(__file__).resolve().parent
-lib_dir = script_dir.parent / "lib"
+
+def _find_lib_dir() -> Path:
+    """æŸ¥æ‰¾ lib ç›®å½• (å…¼å®¹å„ç§å®‰è£…æ–¹å¼)"""
+    script_path = Path(__file__).resolve()
+    candidate = script_path.parent.parent / "lib"
+    if candidate.is_dir() and (candidate / "terminal.py").exists():
+        return candidate
+    if os.environ.get("APPDATA"):
+        candidate = Path(os.environ["APPDATA"]) / "codex-dual" / "lib"
+        if candidate.is_dir() and (candidate / "terminal.py").exists():
+            return candidate
+    candidate = Path.home() / ".local" / "share" / "codex-dual" / "lib"
+    if candidate.is_dir() and (candidate / "terminal.py").exists():
+        return candidate
+    return script_path.parent.parent / "lib"
+
+
+lib_dir = _find_lib_dir()
 sys.path.insert(0, str(lib_dir))
 
 from gemini_comm import GeminiCommunicator
Index: bin/gping
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/bin/gping b/bin/gping
--- a/bin/gping	(revision acdb42e15193d62398f6460571f21a07a82ec921)
+++ b/bin/gping	(date 1766020994082)
@@ -3,11 +3,28 @@
 gping - æµ‹è¯• Gemini è¿é€šæ€§
 """
 
+import os
 import sys
 from pathlib import Path
 
-script_dir = Path(__file__).resolve().parent
-lib_dir = script_dir.parent / "lib"
+
+def _find_lib_dir() -> Path:
+    """æŸ¥æ‰¾ lib ç›®å½• (å…¼å®¹å„ç§å®‰è£…æ–¹å¼)"""
+    script_path = Path(__file__).resolve()
+    candidate = script_path.parent.parent / "lib"
+    if candidate.is_dir() and (candidate / "terminal.py").exists():
+        return candidate
+    if os.environ.get("APPDATA"):
+        candidate = Path(os.environ["APPDATA"]) / "codex-dual" / "lib"
+        if candidate.is_dir() and (candidate / "terminal.py").exists():
+            return candidate
+    candidate = Path.home() / ".local" / "share" / "codex-dual" / "lib"
+    if candidate.is_dir() and (candidate / "terminal.py").exists():
+        return candidate
+    return script_path.parent.parent / "lib"
+
+
+lib_dir = _find_lib_dir()
 sys.path.insert(0, str(lib_dir))
 
 try:
Index: bin/cping
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/bin/cping b/bin/cping
--- a/bin/cping	(revision acdb42e15193d62398f6460571f21a07a82ec921)
+++ b/bin/cping	(date 1766020962006)
@@ -8,9 +8,24 @@
 import os
 from pathlib import Path
 
-# æ·»åŠ libç›®å½•åˆ°Pythonè·¯å¾„
-script_dir = Path(__file__).resolve().parent
-lib_dir = script_dir.parent / "lib"
+
+def _find_lib_dir() -> Path:
+    """æŸ¥æ‰¾ lib ç›®å½• (å…¼å®¹å„ç§å®‰è£…æ–¹å¼)"""
+    script_path = Path(__file__).resolve()
+    candidate = script_path.parent.parent / "lib"
+    if candidate.is_dir() and (candidate / "terminal.py").exists():
+        return candidate
+    if os.environ.get("APPDATA"):
+        candidate = Path(os.environ["APPDATA"]) / "codex-dual" / "lib"
+        if candidate.is_dir() and (candidate / "terminal.py").exists():
+            return candidate
+    candidate = Path.home() / ".local" / "share" / "codex-dual" / "lib"
+    if candidate.is_dir() and (candidate / "terminal.py").exists():
+        return candidate
+    return script_path.parent.parent / "lib"
+
+
+lib_dir = _find_lib_dir()
 sys.path.insert(0, str(lib_dir))
 
 try:
